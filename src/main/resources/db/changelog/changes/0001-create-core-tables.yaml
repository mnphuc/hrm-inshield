databaseChangeLog:
  - changeSet:
      id: 0001-roles
      author: codex
      changes:
        - createTable:
            tableName: roles
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: name
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
                    unique: true

  - changeSet:
      id: 0001-users
      author: codex
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: username
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: email
                  type: VARCHAR(150)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: password
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: enabled
                  type: BOOLEAN
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
              - column:
                  name: account_non_locked
                  type: BOOLEAN
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
              - column:
                  name: last_login_at
                  type: TIMESTAMP

  - changeSet:
      id: 0001-user-roles
      author: codex
      changes:
        - createTable:
            tableName: user_roles
            columns:
              - column:
                  name: user_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: role_id
                  type: BIGINT
                  constraints:
                    nullable: false
        - addPrimaryKey:
            tableName: user_roles
            columnNames: user_id, role_id
        - addForeignKeyConstraint:
            baseTableName: user_roles
            baseColumnNames: user_id
            referencedTableName: users
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_user_roles_user
        - addForeignKeyConstraint:
            baseTableName: user_roles
            baseColumnNames: role_id
            referencedTableName: roles
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_user_roles_role

  - changeSet:
      id: 0001-employees
      author: codex
      changes:
        - createTable:
            tableName: employees
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: code
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: full_name
                  type: VARCHAR(150)
                  constraints:
                    nullable: false
              - column:
                  name: email
                  type: VARCHAR(150)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: phone
                  type: VARCHAR(30)
              - column:
                  name: department
                  type: VARCHAR(100)
              - column:
                  name: position
                  type: VARCHAR(100)
              - column:
                  name: hire_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: termination_date
                  type: DATE
              - column:
                  name: employment_status
                  type: VARCHAR(50)
              - column:
                  name: base_salary
                  type: DECIMAL(12,2)
              - column:
                  name: manager_id
                  type: BIGINT
              - column:
                  name: user_id
                  type: BIGINT
        - addForeignKeyConstraint:
            baseTableName: employees
            baseColumnNames: manager_id
            referencedTableName: employees
            referencedColumnNames: id
            constraintName: fk_employees_manager
        - addForeignKeyConstraint:
            baseTableName: employees
            baseColumnNames: user_id
            referencedTableName: users
            referencedColumnNames: id
            onDelete: SET NULL
            constraintName: fk_employees_user

  - changeSet:
      id: 0001-attendance
      author: codex
      changes:
        - createTable:
            tableName: attendance_records
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: employee_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: work_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: check_in
                  type: TIME
              - column:
                  name: check_out
                  type: TIME
              - column:
                  name: worked_hours
                  type: DECIMAL(5,2)
              - column:
                  name: notes
                  type: VARCHAR(255)
        - addUniqueConstraint:
            tableName: attendance_records
            columnNames: employee_id, work_date
            constraintName: uq_attendance_employee_date
        - addForeignKeyConstraint:
            baseTableName: attendance_records
            baseColumnNames: employee_id
            referencedTableName: employees
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_attendance_employee

  - changeSet:
      id: 0001-projects
      author: codex
      changes:
        - createTable:
            tableName: projects
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: code
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: name
                  type: VARCHAR(150)
                  constraints:
                    nullable: false
              - column:
                  name: description
                  type: VARCHAR(500)
              - column:
                  name: start_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: end_date
                  type: DATE
              - column:
                  name: status
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: manager_id
                  type: BIGINT
        - addForeignKeyConstraint:
            baseTableName: projects
            baseColumnNames: manager_id
            referencedTableName: employees
            referencedColumnNames: id
            constraintName: fk_projects_manager

  - changeSet:
      id: 0001-project-assignments
      author: codex
      changes:
        - createTable:
            tableName: project_assignments
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: project_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: employee_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: role_name
                  type: VARCHAR(100)
              - column:
                  name: allocation_percent
                  type: DECIMAL(5,2)
              - column:
                  name: start_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: end_date
                  type: DATE
        - addForeignKeyConstraint:
            baseTableName: project_assignments
            baseColumnNames: project_id
            referencedTableName: projects
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_project_assignments_project
        - addForeignKeyConstraint:
            baseTableName: project_assignments
            baseColumnNames: employee_id
            referencedTableName: employees
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_project_assignments_employee

  - changeSet:
      id: 0001-expenses
      author: codex
      changes:
        - createTable:
            tableName: expenses
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: employee_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: project_id
                  type: BIGINT
              - column:
                  name: category
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: amount
                  type: DECIMAL(12,2)
                  constraints:
                    nullable: false
              - column:
                  name: incurred_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: description
                  type: VARCHAR(255)
              - column:
                  name: status
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: expenses
            baseColumnNames: employee_id
            referencedTableName: employees
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_expenses_employee
        - addForeignKeyConstraint:
            baseTableName: expenses
            baseColumnNames: project_id
            referencedTableName: projects
            referencedColumnNames: id
            onDelete: SET NULL
            constraintName: fk_expenses_project

  - changeSet:
      id: 0001-leave-requests
      author: codex
      changes:
        - createTable:
            tableName: leave_requests
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: employee_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: type
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: start_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: end_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: total_days
                  type: DECIMAL(5,2)
                  constraints:
                    nullable: false
              - column:
                  name: reason
                  type: VARCHAR(255)
              - column:
                  name: status
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: approver_id
                  type: BIGINT
              - column:
                  name: decided_at
                  type: DATETIME
        - addForeignKeyConstraint:
            baseTableName: leave_requests
            baseColumnNames: employee_id
            referencedTableName: employees
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_leave_requests_employee
        - addForeignKeyConstraint:
            baseTableName: leave_requests
            baseColumnNames: approver_id
            referencedTableName: employees
            referencedColumnNames: id
            onDelete: SET NULL
            constraintName: fk_leave_requests_approver

  - changeSet:
      id: 0001-payrolls
      author: codex
      changes:
        - createTable:
            tableName: payrolls
            columns:
              - column:
                  name: id
                  type: BIGINT AUTO_INCREMENT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: employee_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: payroll_year
                  type: INT
                  constraints:
                    nullable: false
              - column:
                  name: payroll_month
                  type: INT
                  constraints:
                    nullable: false
              - column:
                  name: base_salary
                  type: DECIMAL(12,2)
                  constraints:
                    nullable: false
              - column:
                  name: overtime_hours
                  type: DECIMAL(5,2)
                  defaultValueNumeric: 0
              - column:
                  name: overtime_amount
                  type: DECIMAL(12,2)
                  defaultValueNumeric: 0
              - column:
                  name: bonus
                  type: DECIMAL(12,2)
                  defaultValueNumeric: 0
              - column:
                  name: deductions
                  type: DECIMAL(12,2)
                  defaultValueNumeric: 0
              - column:
                  name: net_pay
                  type: DECIMAL(12,2)
                  constraints:
                    nullable: false
              - column:
                  name: generated_at
                  type: DATE
                  constraints:
                    nullable: false
        - addUniqueConstraint:
            tableName: payrolls
            columnNames: employee_id, payroll_year, payroll_month
            constraintName: uq_payroll_employee_period
        - addForeignKeyConstraint:
            baseTableName: payrolls
            baseColumnNames: employee_id
            referencedTableName: employees
            referencedColumnNames: id
            onDelete: CASCADE
            constraintName: fk_payrolls_employee
